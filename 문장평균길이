import java.io.*;
import java.util.*;

public class FileAnalyzer {

    public static void main(String[] args) {
        String filePath = "text.txt";

        int totalChars = 0;           // ì „ì²´ ê¸€ì ìˆ˜
        int totalWords = 0;          // ì „ì²´ ë‹¨ì–´ ìˆ˜
        int totalSentences = 0;      // ì „ì²´ ë¬¸ì¥ ìˆ˜
        int koreanCount = 0;         // í•œê¸€ ê¸€ì ìˆ˜
        int englishCount = 0;        // ì˜ë¬¸ ê¸€ì ìˆ˜
        int lineCount = 0;           // ì¤„ ìˆ˜

        List<Integer> sentenceLengths = new ArrayList<>();
        Map<String, Integer> wordFrequency = new HashMap<>();

        try (BufferedReader br = new BufferedReader(new FileReader(filePath))) {
            String line;

            while ((line = br.readLine()) != null) {
                lineCount++;

                // ê¸€ì ìˆ˜ ì„¸ê¸°
                totalChars += line.length();

                // í•œê¸€/ì˜ë¬¸ ê¸€ì ì„¸ê¸°
                for (char c : line.toCharArray()) {
                    if (Character.toString(c).matches("[ê°€-í£]")) {
                        koreanCount++;
                    } else if (Character.isAlphabetic(c)) {
                        englishCount++;
                    }
                }

                // ë‹¨ì–´ ì²˜ë¦¬
                String[] words = line.trim().split("\\s+");
                if (!line.trim().isEmpty()) {
                    totalWords += words.length;

                    // ë‹¨ì–´ ë“±ì¥ íšŸìˆ˜ ê³„ì‚°
                    for (String w : words) {
                        w = w.toLowerCase().replaceAll("[^a-zê°€-í£0-9]", "");
                        if (!w.isEmpty()) {
                            wordFrequency.put(w, wordFrequency.getOrDefault(w, 0) + 1);
                        }
                    }
                }

                // ë¬¸ì¥ ì²˜ë¦¬
                String[] sentences = line.split("[.!?]+");
                for (String s : sentences) {
                    s = s.trim();
                    if (!s.isEmpty()) {
                        totalSentences++;
                        sentenceLengths.add(s.length());
                    }
                }
            }

        } catch (IOException e) {
            e.printStackTrace();
        }

        // ê°€ì¥ ë§ì´ ë‚˜ì˜¨ ë‹¨ì–´ ì°¾ê¸°
        String mostFreqWord = "";
        int maxFreq = 0;
        for (String key : wordFrequency.keySet()) {
            if (wordFrequency.get(key) > maxFreq) {
                mostFreqWord = key;
                maxFreq = wordFrequency.get(key);
            }
        }

        // ë¬¸ì¥ í‰ê·  ê¸¸ì´ ê³„ì‚°
        double avgSentenceLength = 0;
        for (int len : sentenceLengths) {
            avgSentenceLength += len;
        }
        if (!sentenceLengths.isEmpty()) {
            avgSentenceLength /= sentenceLengths.size();
        }

        // ========== ì¶œë ¥ ==========
        System.out.println("===== ğŸ“„ íŒŒì¼ ë¶„ì„ ê²°ê³¼ =====");
        System.out.println("ì´ ì¤„ ìˆ˜: " + lineCount);
        System.out.println("ì´ ê¸€ì ìˆ˜: " + totalChars);
        System.out.println("ì´ ë‹¨ì–´ ìˆ˜: " + totalWords);
        System.out.println("ì´ ë¬¸ì¥ ìˆ˜: " + totalSentences);

        System.out.println("\n===== ğŸ“Š ë¬¸ì¥ ê¸¸ì´ í†µê³„ =====");
        System.out.println("ë¬¸ì¥ë³„ ê¸¸ì´: " + sentenceLengths);
        System.out.printf("ë¬¸ì¥ í‰ê·  ê¸¸ì´: %.2f\n", avgSentenceLength);

        System.out.println("\n===== ğŸ”  ê¸€ì ì¢…ë¥˜ ë¶„ì„ =====");
        System.out.println("í•œê¸€ ê¸€ì ìˆ˜: " + koreanCount);
        System.out.println("ì˜ë¬¸ ê¸€ì ìˆ˜: " + englishCount);

        System.out.println("\n===== ğŸ” ë‹¨ì–´ ë¹ˆë„ =====");
        System.out.println("ê°€ì¥ ë§ì´ ë“±ì¥í•œ ë‹¨ì–´: " + mostFreqWord + " (" + maxFreq + "íšŒ)");

        System.out.println("\n===== ğŸ“ˆ ë¹„ìœ¨ ë¶„ì„ =====");
        System.out.printf("í‰ê·  ê¸€ììˆ˜/ë‹¨ì–´ë¹„: %.2f\n", totalChars / (double) Math.max(totalWords, 1));

    }
}
